      SUBROUTINE ELSY2
C *** FOR USE WITH ELSYM5
C *** ELSY2
C *** ELSYM - PRE COEE
C *** GO OVER THIS PROGRAM TO IMPROVE
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      COMMON E(5),V(5),DI(5),R(100),Z(10),EX(32),
     1        CDAB(5,736),AJ1(184),RJ1(184),RJ0(184),
     2        VSE,SSE,RDP,VDP,RSE,TSE,ST1,ST2,ST3,ST4,
     3        WR,WZ,WRL,RL,PRES,RLP,TST1,TST2,TST3,TST4,
     4        NSYM,NSY,NLSW,NBZ,NGQP,NX,NEX,NR,NRC,NZ,NZC,MSW,
     5        NEL,NEI,NI,NBLL,LAY,NTEST,NTSI,ITS,IND,NAB,NBZC,
     6        KSW1,KSW2,KSW3,KSW4,KSW5,KSW6,KSW7,KSW8,KSW9
      COMMON XL(10),YL(10),XP(10),YP(10),LAYZ(10),
     1  ANS(6,100,10),AS(9,3,10),TITLE(40),IXR(100),NLD,NXY,IO
      COMMON / COM1 /
     1 EI(16,2,2),S(2,2,2),SV(4,9),ISC(4),SA(2,2),RB(2,2),BA(2,2,2),
     2 TB1,TB2,TB3,TB4,TB5,
     3 NE,NEXD2,NEIM1
C *** EXCLUSIVE ROUTINE ARRAYS
      DIMENSION RDET(4)
C
      DO 32 K1=1,NEI
      RDET(K1)= 1.0/( 4.0*( 1.0-V(K1)))
   32 CONTINUE
      NEXD2=NEX/2
      NEIM1=NEI-1
      NE=NEIM1*4+1
C *** DEVELOP ISC ARRAY
      ISC(NEI)=1
      GO TO ( 42,44),NLSW
   42 DO 30 K1=1,NEIM1
      K2=NEI-K1
      ISC(K2)=ISC(K2+1)*2
   30 CONTINUE
   44 K1=1
      DO 10 K2=1,NE,4
      T1=(1.0+V(K1+1))*E(K1)/(E(K1+1)*(1.0+V(K1)))
      T2=1.0-T1
C *** ELEMENTS TOTALLY INDEPENDENT OF M
      EI(K2,1,1)=(-4.0*V(K1)+T1+3.0  )*RDET(K1)
      EI(K2+3,1,1)=EI(K2,1,1)
      EI(K2,2,2)=(-T1*(4.0*V(K1+1)-3.0)+1.0 )*RDET(K1)
      EI(K2+3,2,2)=EI(K2,2,2)
      EI(K2,2,1)=0.0
      EI(K2+3,2,1)=0.0
C *** PORTIONS OF ELEMENTS INDEPENDENT OF M
      SV(K1,1)=(-2.0*DI(K1)*(2.0*V(K1)-1.0-T1*(2.0*V(K1+1)-1.0)))*
     1  RDET(K1)
      SV(K1,2)=(-T2*(4.0*V(K1)-1.0)  )*RDET(K1)
      SV(K1,3)=(-4.0*DI(K1)*(T2*(V(K1)-V(K1+1))))*RDET(K1)
      SV(K1,4)=(-T2*(4.0*V(K1+1)-1.0) )*RDET(K1)
C *** PORTION OF ELEMENTS DEPENDENT ON 1.0/M
      SV(K1,5)=(1.0+2.0*V(K1+1)*(4.0*V(K1)-3.0)
     1  -T1*(1.0+2.0*V(K1)*(4.0*V(K1+1)-3.0))  )*RDET(K1)
      SV(K1,6)=(1.0-2.0*V(K1+1)*(4.0*V(K1)-1.0)
     1  -T1*(1.0-2.0*V(K1)*(4.0*V(K1+1)-1.0)) )*RDET(K1)
C *** PORTIONS OF ELEMENTS DEPENDENT ON M
      T1=(-2.0*T2  )*RDET(K1)
      SV(K1,7)=-DI(K1)*T1
      SV(K1,8)=-DI(K1)**2*T1
      SV(K1,9)=T1
      K1=K1+1
   10 CONTINUE
C *** SET UP SURFACE ARRAY ELEMENTS INDEPENDENT OF M
      S(1,1,2)=-2.0*V(1)
      S(1,2,2)=2.0*V(1)-1.0
      S(2,1,2)=2.0*V(1)
      S(2,2,2)=2.0*V(1)-1.0
      GO TO ( 22,20 ),KSW1
C *** RIGID BASE WITH ROUGH INTERFACE
   20 T1=3.0-4.0*V(NEL)
C *** PORTIONS OF RIGID BASE ELEMENTS INDEPENDENT OF M
      TB1=(1.0-4.0*V(NEL))/T1
C *** PORTIONS OF RIGID BASE ELEMENTS DEPENDENT ON M
      TB3=2.0/T1
      TB4=TB3*DI(NI)
      TB5=TB4*DI(NI)
C *** PORTIONS OF RIGID BASE ELEMENTS DEPENDENT ON 1.0/M
      TB2=4.0*(2.0*V(NEL)-1.0)/T1
   22 RETURN
      END
