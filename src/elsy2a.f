      SUBROUTINE ELSY2A
C *** FOR USE WITH ELSYM5
C *** ELSY2A
C *** SINGLE LAYER SYSTEM
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      COMMON E(5),V(5),DI(5),R(100),Z(10),EX(32),
     1        CDAB(5,736),AJ1(184),RJ1(184),RJ0(184),
     2        VSE,SSE,RDP,VDP,RSE,TSE,ST1,ST2,ST3,ST4,
     3        WR,WZ,WRL,RL,PRES,RLP,TST1,TST2,TST3,TST4,
     4        NSYM,NSY,NLSW,NBZ,NGQP,NX,NEX,NR,NRC,NZ,NZC,MSW,
     5        NEL,NEI,NI,NBLL,LAY,NTEST,NTSI,ITS,IND,NAB,NBZC,
     6        KSW1,KSW2,KSW3,KSW4,KSW5,KSW6,KSW7,KSW8,KSW9
      COMMON XL(10),YL(10),XP(10),YP(10),LAYZ(10),
     1  ANS(6,100,10),AS(9,3,10),TITLE(40),IXR(100),NLD,NXY,IO
      COMMON / COM2 / GP(184)
      COMMON / COM1 / EI(16,2,2),S(2,2,2),SV(4,9),ISC(4),SA(2,2),
     1 RB(2,2),BA(2,2,2),TB1,TB2,TB3,TB4,TB5,NE,NEXD2,NEIM1
C *** EXCLUSIVE ROUTINE ARRAYS
      ST1=2.0*V(1)
      ST2=ST1-1.0
      GO TO ( 10,5),KSW1
C *** SINGLE ELASTIC LAYER WITH RIGID BASE
    5 PC1=1.0/(3.0-4.0*V(1))
      PC2=1.0-4.0*V(1)
      PC3=2.0*PC1
      PC4=2.0*DI(1)
      PC5=PC4*DI(1)
      PC6=4.0*ST2
C *** END RIGID BASE ROUTINE
   10 K6=-3
      K5=0
      DO 40 K2=1,NBZ
      DO 40 K1=1,NGQP
      K6=K6+4
      K5=K5+1
      FM=GP(K5)/WRL
      RFM=1.0/FM
      RFM2=RFM*RFM
      GO TO ( 30,20),KSW1
C *** SINGLE ELASTIC LAYER WITH RIGID BASE
   20 VAL=FM*EX(2)
C *** SINGLE ELASTIC LAYER WITH RIGID BASE REVERTS TO
C *** SINGLE ELASTIC LAYER WITH NO BASE WHEN VAL EXCEEDS TEST
      IF(VAL-TST1) 21,21,30
   21 VAL=EXP(-VAL)
      GO TO (22,24),KSW2
C *** RIGID BASE WITH FULL FRICTION
   22 CM1=(PC2-FM*PC4)*PC1*VAL
      CM2=(PC6-FM*FM*PC5)*PC1*RFM*VAL
      CM3=PC3*FM*VAL
      CM4=(PC2+FM*PC4)*PC1*VAL
      SA(1,1)=FM+FM*CM1+ST1*CM3
      SA(1,2)=-ST1+FM*CM2+ST1*CM4
      SA(2,1)=-FM+FM*CM1+ST2*CM3
      SA(2,2)=ST2+FM*CM2+ST2*CM4
      GO TO 23
C *** RIGID BASE WITH NO FRICTION
   24 SA(1,1)=FM-FM*VAL
      SA(1,2)=-ST1+(ST1-2.0*FM*DI(1))*VAL
      SA(2,1)=-FM-FM*VAL
      SA(2,2)=ST2+(ST2-2.0*FM*DI(1))*VAL
   23 CDAB(1,K6)=-SA(1,2)*RFM2/(SA(2,1)*(-SA(1,2))+SA(2,2)*SA(1,1))
      CDAB(1,K6+1)=SA(1,1)*CDAB(1,K6)/(-SA(1,2))
      GO TO (25,26),KSW2
C *** RIGID BASE WITH FULL FRICTION
   25 CDAB(1,K6+2)=CM1*CDAB(1,K6)+CM2*CDAB(1,K6+1)
      CDAB(1,K6+3)=CM3*CDAB(1,K6)+CM4*CDAB(1,K6+1)
      GO TO 40
C *** RIGID BASE WITH NO FRICTION
   26 CDAB(1,K6+2)=-(CDAB(1,K6)+2.0*DI(1)*CDAB(1,K6+1))*VAL
      CDAB(1,K6+3)=CDAB(1,K6+1)*VAL
      GO TO 40
C *** SINGLE ELASTIC LAYER - NO BASE
   30 CDAB(1,K6)=-ST1*RFM2*RFM
      CDAB(1,K6+1)=-RFM2
      CDAB(1,K6+2)=0.0
      CDAB(1,K6+3)=0.0
   40 CONTINUE
      RETURN
      END
