      SUBROUTINE ELSY3A ( FM )
C *** FOR USE WITH ELSYM5
C *** ELSY3A
C *** MULTIPLY S(K,I,J) AND EI(K,I,J) FOR ALL M VALUES
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      COMMON E(5),V(5),DI(5),R(100),Z(10),EX(32),
     1        CDAB(5,736),AJ1(184),RJ1(184),RJ0(184),
     2        VSE,SSE,RDP,VDP,RSE,TSE,ST1,ST2,ST3,ST4,
     3        WR,WZ,WRL,RL,PRES,RLP,TST1,TST2,TST3,TST4,
     4        NSYM,NSY,NLSW,NBZ,NGQP,NX,NEX,NR,NRC,NZ,NZC,MSW,
     5        NEL,NEI,NI,NBLL,LAY,NTEST,NTSI,ITS,IND,NAB,NBZC,
     6        KSW1,KSW2,KSW3,KSW4,KSW5,KSW6,KSW7,KSW8,KSW9
      COMMON XL(10),YL(10),XP(10),YP(10),LAYZ(10),
     1  ANS(6,100,10),AS(9,3,10),TITLE(40),IXR(100),NLD,NXY,IO
      COMMON / COM1 /
     1 EI(16,2,2),S(2,2,2),SV(4,9),ISC(4),SA(2,2),RB(2,2),BA(2,2,2),
     2 TB1,TB2,TB3,TB4,TB5,
     3 NE,NEXD2,NEIM1
C *** EXCLUSIVE ROUTINE ARRAYS
      DIMENSION TP(5,2,2),ITA(4),ITAB(4),SEI(2,2,2)
      RFM= 1.0/FM
      GO TO ( 34,32),KSW1
C *** START RIGID BASE ROUTINE
   32 K6=0
      K1=NE+1
      K3=K1+2
      DO 38 K2=K1,K3,2
      K6=K6+1
      DO 38 K4=1,2
      DO 38 K5=1,2
      SEI(K6,K5,K4)=EI(K2,K5,K4)
      EI(K2,K5,K4)=BA(K6,K5,K4)
   38 CONTINUE
C *** END RIGID BASE ROUTINE
   34 DO 28 K1=1,2
      DO 28 K2=1,2
      SA(K1,K2)=0.0
   28 CONTINUE
      ITAB(1)=3
      K5=1
      DO 100 K1=1,2
      DO 5 K2=1,2
      DO 5 K3=1,2
      TP(1,K2,K3)=S(K1,K2,K3)
    5 CONTINUE
      DO 90 K4=1,NEXD2
C *** CHECK EXPONENT VALUE
      VAL=FM*EX(K5)
      IF(VAL-TST1) 6,6,89
    6 VAL=EXP(-VAL)
C *** DEVELOP INDEX TO ADD ARRAY
      DO 10 K2=1,NEI
      IT=K5-1
    7 ITT=IT/ISC(K2)
      IF(ITT-3) 9,9,8
    8 IT=IT-4*ISC(K2)
      GO TO 7
    9 ITA(K2)=ITT
   10 CONTINUE
C *** CHECK AGAINST BACK INDEX TO ADD ARRAY
      DO 15 K2=1,NEI
      K3=K2
      IF(ITA(K2)-ITAB(K2)) 16,15,16
   15 CONTINUE
C *** K3 IS NOW THE INDEX FOR THE TP AND THE ITA ARRAYS
C *** SET ITA BACK ARRAY
   16 DO 26 K2=1,NEI
      ITAB(K2)=ITA(K2)
   26 CONTINUE
      K2=(K3-1)*4+1
      DO 20 K10=K2,NE,4
      K6=K10+ITA(K3)
      DO 22 K7=1,2
      DO 22 K8=1,2
      SUM=0.0
      DO 21 K9=1,2
      SUM=SUM+TP(K3,K7,K9)*EI(K6,K9,K8)
   21 CONTINUE
      TP(K3+1,K7,K8)=SUM
   22 CONTINUE
      K3=K3+1
   20 CONTINUE
      DO 24 K7=1,2
      DO 24 K8=1,2
      SA(K7,K8)=SA(K7,K8)+TP(K3,K7,K8)*VAL
   24 CONTINUE
   89 K5=K5+NX
   90 CONTINUE
  100 CONTINUE
      GO TO ( 85,84),KSW1
C *** START RIGID BASE ROUTINE
C *** REPLACE BOTTOM EI ELEMENTS
   84 K6=0
      K1=NE+1
      K3=K1+2
      DO 83 K2=K1,K3,2
      K6=K6+1
      DO 83 K4=1,2
      DO 83 K5=1,2
      EI(K2,K5,K4)=SEI(K6,K5,K4)
   83 CONTINUE
C *** END RIGID BASE ROUTINE
   85 RETURN
      END
